// src/components/Scroll.astro
<script>
    import LocomotiveScroll from "locomotive-scroll";
    import "locomotive-scroll/dist/locomotive-scroll.css";

    document.addEventListener("DOMContentLoaded", () => {
        const isMobile = window.matchMedia("(max-width: 768px)").matches;
        if (isMobile) return;

        const scrollContainer = document.querySelector(
            "[data-scroll-container]",
        ) as HTMLElement;

        if (!scrollContainer) {
            console.error(
                "Locomotive Scroll: Element with data-scroll-container not found.",
            );
            return;
        }

        const scroll = new LocomotiveScroll({
            el: scrollContainer,
            smooth: true,
            lerp: 0.07,
            multiplier: 1.5,
        });

        // Listen to the Locomotive Scroll 'scroll' event
        scroll.on("scroll", (obj) => {
            // Dispatch a custom event with the scroll data
            const event = new CustomEvent("loco-scroll", {
                detail: {
                    scrollPosition: obj.scroll.y,
                },
            });
            window.dispatchEvent(event);
        });

        window.addEventListener("beforeunload", () => {
            scroll.destroy();
        });
    });
</script>
