---
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Projects from "../components/Projects.astro";
import Experience from "../components/Experience.astro";
import Education from "../components/Education.astro";
import Footer from "../components/Footer.astro";
import { siteConfig } from "../config";
import "../styles/global.css";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={siteConfig.description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <title>{siteConfig.name}</title>
  </head>

  <body>
    <Header />
    <main id="main">
      <Hero />
      <About />
      <Projects />
      <Experience />
      <Education />
      <Footer />
    </main>
    <script is:inline>
      if (window.innerWidth > 768) {
        // run the smooth scroll logic

        const body = document.body;
        const main = document.getElementById("main");

        let sx = 0,
          sy = 0;
        let dx = sx,
          dy = sy;

        function li(a, b, n) {
          return (1 - n) * a + n * b;
        }

        // Adjust body height to allow scrolling
        function updateBodyHeight() {
          body.style.height = main.scrollHeight + "px";
        }

        updateBodyHeight();
        window.addEventListener("resize", updateBodyHeight);

        window.addEventListener("scroll", () => {
          sx = window.pageXOffset;
          sy = window.pageYOffset;
        });

        function render() {
          dx = li(dx, sx, 0.07);
          dy = li(dy, sy, 0.07);

          main.style.transform = `translate3d(-${dx}px, -${dy}px, 0)`;

          // Update header based on scroll position
          const header = document.getElementById("header");
          if (header) {
            if (dy > 100) {
              header.classList.add("backdrop-blur-sm");
            } else {
              header.classList.remove("backdrop-blur-sm");
            }
          }

          requestAnimationFrame(render);
        }

        requestAnimationFrame(render);
      }
      // Handle internal anchor links (#about, #projects, etc.)
      document.querySelectorAll('a[href^="#"]').forEach((link) => {
        link.addEventListener("click", (e) => {
          const targetId = link.getAttribute("href").substring(1);
          const target = document.getElementById(targetId);
          if (target) {
            e.preventDefault();
            // Scroll the window manually so your momentum scroll picks it up
            window.scrollTo({
              top: target.offsetTop,
              behavior: "smooth",
            });
          }
        });
      });
    </script>
  </body>
</html>
